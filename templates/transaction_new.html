{% extends 'layout.html' %}

{% block title %}New Transaction{% endblock %}

{% block content %}


<div class="button-container">

    <!--<button onclick="window.location.href='/customer/new'">
        <i class="fas fa-users  fa-lg"></i> Create Customer
    </button> -->

    <button onclick="window.location.href='{{ url_for('get_transactions') }}'">
        <i class="fas fa-arrow-left  fa-lg"></i> Back
    </button>
    <button onclick="window.location.href='{{ url_for('search_transactions') }}'">
        <i class="fas fa-search  fa-lg"></i> Search Transactions
    </button>
</div>



<div class="form-container ">


    <form action="{{ url_for('create_transaction') }}" method="POST">
        <!--Transaction Type Dropdown -->
        <label for="type_id">Transaction Type:</label><br>
        <select id="type_id" name="type_id" onchange="toggleFields()" required>
            <option value="">Select Transaction Type</option>
            <option value="1">Deposit</option>
            <option value="2">Withdrawal</option>
            <option value="3">Transfer</option>
        </select><br>
 
        <!-- Account From Field -->
        <label for="account_from" id="account_from_label">Account From ID:</label><br>
        <input type="text" id="account_from" name="account_from"><br>
 
        <!-- Account To Field -->
        <label for="account_to" id="account_to_label" >Account To ID:</label><br>
        <input type="text" id="account_to" name="account_to"><br>
 
        <!-- Amount Field -->
        <label for="amount">Amount (Â£):</label><br>
        <input type="number" id="amount" name="amount" required><br>
 
        <!-- Button to submit the form -->
        <div class="button-container">
            <button type="submit">Create Transaction</button>
        </div>
    </form>

    <!-- JavaScript to handle form field visibility and null values -->
    <script>
        function toggleFields() {
            var type = document.getElementById("type_id").value;
            var accountFromField = document.getElementById("account_from");
            var accountToField = document.getElementById("account_to");
            var accountFromLabel = document.getElementById("account_from_label");
            var accountToLabel = document.getElementById("account_to_label");


            // Reset required attributes
            
            accountFromField.required = false;
            accountToField.required = false;
            

           

            // Handle field visibility and null values based on transaction type
            if (type === "1") { // Deposit
                accountFromField.hidden = true;
                accountFromField.value = ""; // Set value to NULL (empty) for hidden field
                accountFromField.disabled = true;
                accountToField.hidden = false;
                accountToField.required = true;
                accountToField.disabled = false;
                accountFromLabel.hidden= true;
                accountFromLabel.disabled=true;
                accountToLabel.hidden=false;
                accountTolabel.disabled=false;

                
            } else if (type === "2") { // Withdrawal
                accountFromField.hidden = false;
                accountFromField.required = true;
                accountFromField.disabled = false;

                accountToField.hidden = true;
                accountToField.value = ""; // Set value to empty
                accountToField.disabled = true; // Disable to avoid validation issues
                accountFromLabel.hidden= false;
                accountFromLabel.disabled=false;
                accountToLabel.hidden=true;
                accountTolabel.disabled=true;
            } else if (type === "3") { // Transfer
                accountFromField.hidden = false;
                accountFromField.required = true;
                accountFromField.disabled = false;

                accountToField.hidden = false;
                accountToField.required = true;
                accountToField.disabled = false;
                accountFromLabel.hidden= false;
                accountFromLabel.disabled=false;
                accountToLabel.hidden=false;
                accountTolabel.disabled=false;

            } else {
                accountFromField.hidden = false;
                accountFromField.disabled = false;

                accountToField.hidden = false;
                accountToField.disabled = false;
                accountFromLabel.hidden= false;
                accountFromLabel.disabled=false;
                accountToLabel.hiddn=false;
                accountTolabel.disabled=false;
            }
        }

        // Initialize fields on page load
        document.addEventListener("DOMContentLoaded", toggleFields);
    </script>

    {% endblock %}